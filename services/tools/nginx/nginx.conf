events {}
http {
  map $http_upgrade $connection_upgrade {
    default upgrade;
    ''      close;
  }
  server {
      location / {
          proxy_pass http://host.docker.internal:9000;
      }
      location = /webinterface/ {
          proxy_pass http://host.docker.internal:9000;
      }
      location ~ /webinterface/.* {
          proxy_pass https://front-antmes-dev-01.antsolutions.cloud;
      }
      location /api {
          proxy_pass https://front-antmes-dev-01.antsolutions.cloud;
      }
      location /images {
          proxy_pass https://front-antmes-dev-01.antsolutions.cloud;
      }
      location /rts-web {
          proxy_pass http://host.docker.internal:9091;
      }
      location /paperless-web {
          proxy_pass http://host.docker.internal:9113;
      }
      location /work-orders-web {
          proxy_pass http://host.docker.internal:9115;
      }
      location /spare-parts-web {
          proxy_pass http://host.docker.internal:9149;
      }
      location /checklists-web {
          proxy_pass http://host.docker.internal:9151;
      }
      location /cmms-service-accounts-web {
          proxy_pass http://host.docker.internal:9175;
      }
      location /alarms-web {
          proxy_pass http://host.docker.internal:9173;
      }
      location /state-manager-web {
          proxy_pass http://host.docker.internal:9117;
      }
      location /navbar {
          proxy_pass http://host.docker.internal:9093;
      }
      location /loginpanel {
          proxy_pass http://host.docker.internal:9095;
      }
      location /navigation {
          proxy_pass http://host.docker.internal:9097;
      }
      location ~ /rts.v1 {
          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
      location ~ /paperless.v1 {
          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
      location ~ /work_orders.v1 {
                  # Those headers will be added by oathkeeper on production for authenticated users
          # for now added only for comments because it is necessary for comments to work on local env
          proxy_set_header x-ant-user "TEST_USER";
          proxy_set_header x-ant-user-roles "EXAMPLE_ROLE,EXAMPLE_ROLE2";

          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
      location ~ /changeovers.v1 {
          proxy_set_header x-ant-user "TEST_USER";
          proxy_set_header x-ant-user-roles "EXAMPLE_ROLE,EXAMPLE_ROLE2";

          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
        location ~ /states.v1 {
          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
      location ~ /checklists.v1 {
          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
      location ~ /assets.v1 {
          proxy_http_version 1.1;
          # increased max body size to 20MB for spreadsheet uploads
          client_max_body_size 20M;
          proxy_pass http://host.docker.internal:8080;
      }
      location ~ /comments.v1 {
          # Those headers will be added by oathkeeper on production for authenticated users
          # for now added only for comments because it is necessary for comments to work on local env
        #   proxy_set_header x-ant-user "TEST_USER";
        #   proxy_set_header x-ant-user-roles "EXAMPLE_ROLE,EXAMPLE_ROLE2";

          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
      location ~ /localization.v1 {
          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
      location ~ /mes3.v1 {
          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
      location ~ /aos.v1 {
          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
      location ~ /rbac.v1 {
          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
      location ~ /api_keys.v1 {
          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
      location ~ /triggers.v1 {
          proxy_set_header x-ant-user "TEST_USER";
          proxy_set_header x-ant-user-roles "EXAMPLE_ROLE1,EXAMPLE_ROLE2";

          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
      location ~ /counters_monitor.v1 {
          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
      location ~ /counters.v1 {
          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
      location ~ /cmms_stats.v1 {
          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
      location ~ /inventory.v1 {
          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
      location ~ /paperless_manager.v1 {
          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
          proxy_connect_timeout 300s;
          proxy_read_timeout 300s;
          proxy_send_timeout 300s;
          proxy_set_header x-ant-user "TEST_USER";
          proxy_set_header x-ant-user-roles "EXAMPLE_ROLE,EXAMPLE_ROLE2";
      }
      location ~ /spare_parts.v1 {
          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
      location ~ /samples/v1 {
          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8081;
          proxy_set_header x-ant-user "TEST_USER";
          proxy_set_header x-ant-user-roles "EXAMPLE_ROLE,EXAMPLE_ROLE2";
      }
      location ~ /skills/v1 {
          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8082;
          proxy_set_header x-ant-user "TEST_USER";
          proxy_set_header x-ant-user-roles "SkillsManager/SKILLS_SUPERADMIN";
          proxy_set_header x-ant-user-metadata "";
      }
      location /operator-panel-web {
        proxy_pass http://host.docker.internal:9159;
      }
      location ~ /alarms.v1 {
          proxy_http_version 1.1;
          proxy_pass http://host.docker.internal:8080;
      }
      location /web-eventbus {
        proxy_pass http://host.docker.internal:10176;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection $connection_upgrade;
        proxy_set_header x-ant-user "test";
      }
  }
}
